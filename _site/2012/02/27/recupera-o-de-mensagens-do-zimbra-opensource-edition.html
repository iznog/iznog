<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Recuperação de mensagens do Zimbra opensource edition | Notas do Paulo</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Recuperação de mensagens do Zimbra opensource edition" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Na utilização do Zimbra v7 open source edition, não existe nenhuma ferramenta para efectuar os backups.Assim após ter efectuado os backups para um servidor de backups por rsync (passos que colocarei mais tarde), importa ter a certeza como recuperar os ficheiros no caso de necessidade de reposição das mensagens de uma conta.As mensagens encontram-se na pasta /opt/zimbra/store , sendo que dentro desta temos duas subpastas &quot;0&quot; e &quot;incoming&quot;.As mensagens encontram-se na pasta &quot;0&quot; e dentro desta teremos várias pastas também com numeros que corresponde uma&nbsp; a cada utilizador.Primeiro problema... qual a pasta do utilizador em questão?Solução encontrada, fazer os seguintes passos:Usar o utilizador zimbra:su - zimbraProcurar a password do mysql:zmlocalconfig -s | grep mysql | grep passwordDeverá aparecer várias linhas em que uma delas será a password de root do mysql.De seguida encontrar o id do utilizador:mysql -u root -pColocar a password obtida anteriormente.mysql&gt;use zimbra;mysql&gt;SELECT id FROM mailbox where comment like &#39;%&lt;utilizadorzimbra&gt;%&#39;;Iremos obter um id que corresponderá ao nome da pasta (um numero) que contêm as mensagens.Após isto já saberemos qual a pasta do utilizador em questão e acedendo à pasta do mesmo poderemos obter as mensagens.Segundo problema ... as subpastas numeradas correspondem a que pasta na lista do utilizador?Não sei :)&nbsp; &quot;trial and error&quot;, o que podemos fazer é repor as mensagens na conta do utilizador.Ver o link http://www.zimbra.com/forums/installation/12617-recover-data-store-folders.html que contêm algumas sugestões que poderão ajudar.O que eu fiz foi copiar as mensagens do servidor de backup de volta para o servidor do zimbra para a pasta /opt/zimbra/backup e de seguida importei as mensagens para a conta do utilizador:Assumindo que as subpastas encontram-se em /opt/zimbra/backup/&lt;idutilizador&gt;/ usei os seguintes comandos:zmmailbox adminAuthenticate &lt;utilizadoradmin&gt; &lt;password&gt;zmmailbox -zadminSeleccionar a mailbox para efectuar a reposicaoselectMailbox user@domainCriei uma pasta para cada das pastas que pretendia repôr:mbox&gt;createFolder /Recuperacao&lt;numero da pasta&gt;mbox&gt;addMessage /Recuperacao&lt;numero da pasta&gt; backup/&lt;idutilizador&gt;/&lt;numero da pasta&gt;Repeti o createFolder e o addMessage para cada uma das pastas que pretendia repôr.para sair exitaté sair da consola/sessão.No final o utilizador terá nessas pastas as mensagens do backup com as quais poderá fazer o que pretender.Nota: atenção às quotas dos utilizadores, caso estejam definidas, para que não se chegue ao limite da mesma.Caso isso seja um problema, o melhor será criar um utilizador novo e importar para esse as mensagens, efectuar o tratamento necessário nesse utilizador e eventualmente sincronizar as mesmas com o imapsync (ou qualquer outro utilitário que sincronize as contas imap)." />
<meta property="og:description" content="Na utilização do Zimbra v7 open source edition, não existe nenhuma ferramenta para efectuar os backups.Assim após ter efectuado os backups para um servidor de backups por rsync (passos que colocarei mais tarde), importa ter a certeza como recuperar os ficheiros no caso de necessidade de reposição das mensagens de uma conta.As mensagens encontram-se na pasta /opt/zimbra/store , sendo que dentro desta temos duas subpastas &quot;0&quot; e &quot;incoming&quot;.As mensagens encontram-se na pasta &quot;0&quot; e dentro desta teremos várias pastas também com numeros que corresponde uma&nbsp; a cada utilizador.Primeiro problema... qual a pasta do utilizador em questão?Solução encontrada, fazer os seguintes passos:Usar o utilizador zimbra:su - zimbraProcurar a password do mysql:zmlocalconfig -s | grep mysql | grep passwordDeverá aparecer várias linhas em que uma delas será a password de root do mysql.De seguida encontrar o id do utilizador:mysql -u root -pColocar a password obtida anteriormente.mysql&gt;use zimbra;mysql&gt;SELECT id FROM mailbox where comment like &#39;%&lt;utilizadorzimbra&gt;%&#39;;Iremos obter um id que corresponderá ao nome da pasta (um numero) que contêm as mensagens.Após isto já saberemos qual a pasta do utilizador em questão e acedendo à pasta do mesmo poderemos obter as mensagens.Segundo problema ... as subpastas numeradas correspondem a que pasta na lista do utilizador?Não sei :)&nbsp; &quot;trial and error&quot;, o que podemos fazer é repor as mensagens na conta do utilizador.Ver o link http://www.zimbra.com/forums/installation/12617-recover-data-store-folders.html que contêm algumas sugestões que poderão ajudar.O que eu fiz foi copiar as mensagens do servidor de backup de volta para o servidor do zimbra para a pasta /opt/zimbra/backup e de seguida importei as mensagens para a conta do utilizador:Assumindo que as subpastas encontram-se em /opt/zimbra/backup/&lt;idutilizador&gt;/ usei os seguintes comandos:zmmailbox adminAuthenticate &lt;utilizadoradmin&gt; &lt;password&gt;zmmailbox -zadminSeleccionar a mailbox para efectuar a reposicaoselectMailbox user@domainCriei uma pasta para cada das pastas que pretendia repôr:mbox&gt;createFolder /Recuperacao&lt;numero da pasta&gt;mbox&gt;addMessage /Recuperacao&lt;numero da pasta&gt; backup/&lt;idutilizador&gt;/&lt;numero da pasta&gt;Repeti o createFolder e o addMessage para cada uma das pastas que pretendia repôr.para sair exitaté sair da consola/sessão.No final o utilizador terá nessas pastas as mensagens do backup com as quais poderá fazer o que pretender.Nota: atenção às quotas dos utilizadores, caso estejam definidas, para que não se chegue ao limite da mesma.Caso isso seja um problema, o melhor será criar um utilizador novo e importar para esse as mensagens, efectuar o tratamento necessário nesse utilizador e eventualmente sincronizar as mesmas com o imapsync (ou qualquer outro utilitário que sincronize as contas imap)." />
<link rel="canonical" href="http://localhost:4000/2012/02/27/recupera-o-de-mensagens-do-zimbra-opensource-edition.html" />
<meta property="og:url" content="http://localhost:4000/2012/02/27/recupera-o-de-mensagens-do-zimbra-opensource-edition.html" />
<meta property="og:site_name" content="Notas do Paulo" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-02-27T00:00:00+00:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/2012/02/27/recupera-o-de-mensagens-do-zimbra-opensource-edition.html","headline":"Recuperação de mensagens do Zimbra opensource edition","dateModified":"2012-02-27T00:00:00+00:00","datePublished":"2012-02-27T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2012/02/27/recupera-o-de-mensagens-do-zimbra-opensource-edition.html"},"description":"Na utilização do Zimbra v7 open source edition, não existe nenhuma ferramenta para efectuar os backups.Assim após ter efectuado os backups para um servidor de backups por rsync (passos que colocarei mais tarde), importa ter a certeza como recuperar os ficheiros no caso de necessidade de reposição das mensagens de uma conta.As mensagens encontram-se na pasta /opt/zimbra/store , sendo que dentro desta temos duas subpastas &quot;0&quot; e &quot;incoming&quot;.As mensagens encontram-se na pasta &quot;0&quot; e dentro desta teremos várias pastas também com numeros que corresponde uma&nbsp; a cada utilizador.Primeiro problema... qual a pasta do utilizador em questão?Solução encontrada, fazer os seguintes passos:Usar o utilizador zimbra:su - zimbraProcurar a password do mysql:zmlocalconfig -s | grep mysql | grep passwordDeverá aparecer várias linhas em que uma delas será a password de root do mysql.De seguida encontrar o id do utilizador:mysql -u root -pColocar a password obtida anteriormente.mysql&gt;use zimbra;mysql&gt;SELECT id FROM mailbox where comment like &#39;%&lt;utilizadorzimbra&gt;%&#39;;Iremos obter um id que corresponderá ao nome da pasta (um numero) que contêm as mensagens.Após isto já saberemos qual a pasta do utilizador em questão e acedendo à pasta do mesmo poderemos obter as mensagens.Segundo problema ... as subpastas numeradas correspondem a que pasta na lista do utilizador?Não sei :)&nbsp; &quot;trial and error&quot;, o que podemos fazer é repor as mensagens na conta do utilizador.Ver o link http://www.zimbra.com/forums/installation/12617-recover-data-store-folders.html que contêm algumas sugestões que poderão ajudar.O que eu fiz foi copiar as mensagens do servidor de backup de volta para o servidor do zimbra para a pasta /opt/zimbra/backup e de seguida importei as mensagens para a conta do utilizador:Assumindo que as subpastas encontram-se em /opt/zimbra/backup/&lt;idutilizador&gt;/ usei os seguintes comandos:zmmailbox adminAuthenticate &lt;utilizadoradmin&gt; &lt;password&gt;zmmailbox -zadminSeleccionar a mailbox para efectuar a reposicaoselectMailbox user@domainCriei uma pasta para cada das pastas que pretendia repôr:mbox&gt;createFolder /Recuperacao&lt;numero da pasta&gt;mbox&gt;addMessage /Recuperacao&lt;numero da pasta&gt; backup/&lt;idutilizador&gt;/&lt;numero da pasta&gt;Repeti o createFolder e o addMessage para cada uma das pastas que pretendia repôr.para sair exitaté sair da consola/sessão.No final o utilizador terá nessas pastas as mensagens do backup com as quais poderá fazer o que pretender.Nota: atenção às quotas dos utilizadores, caso estejam definidas, para que não se chegue ao limite da mesma.Caso isso seja um problema, o melhor será criar um utilizador novo e importar para esse as mensagens, efectuar o tratamento necessário nesse utilizador e eventualmente sincronizar as mesmas com o imapsync (ou qualquer outro utilitário que sincronize as contas imap).","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body>

    <header>
        <div class="container">
            <a id="a-title" href="/">
                <h1>Notas do Paulo</h1>
            </a>
            <h2>Notas sobre diversos temas, normalmente relacionados com tecnologia</h2>

            <a href="/">Blog</a>
            <a href="/sobre/">Sobre</a>
        </div>
    </header>

    <div class="container">
        <section id="main_content">
            <small>27 February 2012</small>
<h1>Recuperação de mensagens do Zimbra opensource edition</h1>

<div class='post'>
Na utilização do Zimbra v7 open source edition, não existe nenhuma ferramenta para efectuar os backups.<br />Assim  após ter efectuado os backups para um servidor de backups por rsync  (passos que colocarei mais tarde), importa ter a certeza como recuperar  os ficheiros no caso de necessidade de reposição das mensagens de uma  conta.<br />As mensagens encontram-se na pasta /opt/zimbra/store , sendo que dentro desta temos duas subpastas "0" e "incoming".<br />As  mensagens encontram-se na pasta "0" e dentro desta teremos várias  pastas também com numeros que corresponde uma&nbsp; a cada utilizador.<br />Primeiro problema... qual a pasta do utilizador em questão?<br />Solução encontrada, fazer os seguintes passos:<br />Usar o utilizador zimbra:<br /><pre>su - zimbra</pre><br />Procurar a password do mysql:<br /><pre>zmlocalconfig -s | grep mysql | grep password</pre><br />Deverá aparecer várias linhas em que uma delas será a password de root do mysql.<br />De seguida encontrar o id do utilizador:<br /><pre>mysql -u root -p</pre><br /><br />Colocar a password obtida anteriormente.<br /><pre>mysql&gt;use zimbra;<br />mysql&gt;SELECT id FROM mailbox where comment like '%&lt;utilizadorzimbra&gt;%';<br /></pre><br /><br /><br /><br />Iremos obter um id que corresponderá ao nome da pasta (um numero) que contêm as mensagens.<br />Após isto já saberemos qual a pasta do utilizador em questão e acedendo à pasta do mesmo poderemos obter as mensagens.<br />Segundo problema ... as subpastas numeradas correspondem a que pasta na lista do utilizador?<br />Não sei :)&nbsp; "trial and error", o que podemos fazer é repor as mensagens na conta do utilizador.<br />Ver  o link  http://www.zimbra.com/forums/installation/12617-recover-data-store-folders.html  que contêm algumas sugestões que poderão ajudar.<br />O que eu fiz foi  copiar as mensagens do servidor de backup de volta para o servidor do  zimbra para a pasta /opt/zimbra/backup e de seguida importei as  mensagens para a conta do utilizador:<br />Assumindo que as subpastas encontram-se em /opt/zimbra/backup/&lt;idutilizador&gt;/ usei os seguintes comandos:<br /><br /><pre>zmmailbox adminAuthenticate &lt;utilizadoradmin&gt; &lt;password&gt;<br />zmmailbox -zadmin</pre><br />Seleccionar a mailbox para efectuar a reposicao<br /><pre>selectMailbox user@domain</pre><br />Criei uma pasta para cada das pastas que pretendia repôr:<br /><pre>mbox&gt;createFolder /Recuperacao&lt;numero da pasta&gt;<br />mbox&gt;addMessage /Recuperacao&lt;numero da pasta&gt; backup/&lt;idutilizador&gt;/&lt;numero da pasta&gt;<br /></pre><br />Repeti o createFolder e o addMessage para cada uma das pastas que pretendia repôr.<br />para sair <br /><pre>exit</pre><br />até sair da consola/sessão.<br />No final o utilizador terá nessas pastas as mensagens do backup com as quais poderá fazer o que pretender.<br />Nota: atenção às quotas dos utilizadores, caso estejam definidas, para que não se chegue ao limite da mesma.<br />Caso  isso seja um problema, o melhor será criar um utilizador novo e  importar para esse as mensagens, efectuar o tratamento necessário nesse  utilizador e eventualmente sincronizar as mesmas com o imapsync (ou  qualquer outro utilitário que sincronize as contas imap).</div>




  <small>tags: <button></button></small>

        </section>
    </div>
    <div class="footer">
        <div class="contact">
            paulocruz.com.pt<br />
        </div>
    </div>

    
</body>

</html>